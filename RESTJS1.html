<html>
  <body>
    <form onsubmit="saveToLocalStorage(event)">
      <label>TodoName</label>
      <input type="text" name="todoname" id="todoNameId">
      <label>Description</label>
      <input type="text" name="description" id="descriptionId">
      
      <button>Add Item</button>
    </form>
    <h2>Todo</h2>
    <ul id="todoList"></ul>
    <h2>Done</h2>
    <ul id="doneList"></ul>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
    <script>
        function saveToLocalStorage(event) {
            event.preventDefault(); 
          
            
            var todoName = document.getElementById("todoNameId").value;
            var description = document.getElementById("descriptionId").value;
          
            
            var obj = {
              name: todoName,
              description: description,
              completed: false 
            };
          
            axios
              .post(
                "https://crudcrud.com/api/f303977ed458470fbb43f0d13f4fb142/candies1",
                obj
              )
              .then((response) => {
                showUserOnScreen(response.data);
                console.log(response);
              })
              .catch((err) => {
                document.body.innerHTML =
                  document.body.innerHTML + "<h4>Something went wrong</h4>";
                console.log(err);
              });
          }
          
          function showUserOnScreen(obj) {
            document.getElementById("todoNameId").value = "";
            document.getElementById("descriptionId").value = "";
          
            if (localStorage.getItem(obj._id) !== null) {
              removeUserfromScreen(obj._id);
            }
          
            const parentNode = obj.completed ? document.getElementById('doneList') : document.getElementById('todoList');
          
            const childHTML = `
              <li id=${obj._id}>
                  ${obj.name} - ${obj.description}
                  <button onclick="rightTick('${obj._id}')">✅</button>
                  <button onclick="wrongTick('${obj._id}')">❌</button>
              </li>`;
          
            parentNode.innerHTML = parentNode.innerHTML + childHTML;
          
          
            
          }
          window.addEventListener("DOMContentLoaded", () => {
            axios
              .get(
                "https://crudcrud.com/api/f303977ed458470fbb43f0d13f4fb142/candies1"
              )
              .then((response) => {
                for (var i = 0; i < response.data.length; i++) {
                  showUserOnScreen(response.data[i]);
                }
              })
              .catch((err) => {
                console.log(err);
              });
          });
          
          
          

function rightTick(userId) {
    axios
      .put(
        `https://crudcrud.com/api/f303977ed458470fbb43f0d13f4fb142/candies1/${userId}`,
        { completed: true }
      )
      .then((response) => {
        const listItem = document.getElementById(userId);
        const doneList = document.getElementById('doneList');
                  
        doneList.appendChild(listItem);
      })
      .catch((err) => {
        console.log(err);
      });
  }
  
  function wrongTick(name, description, userId) {
    axios
      .put(
        `https://crudcrud.com/api/f303977ed458470fbb43f0d13f4fb142/candies1/${userId}`,
        { name: name, description: description, completed: false }
      )
      .then((response) => {
        const listItem = document.getElementById(userId);
        const todoList = document.getElementById('todoList');
                  
        todoList.appendChild(listItem);
      })
      .catch((err) => {
        console.log(err);
      });
  }
  
          
          function removeUserfromScreen(userId){
            const parentNode = document.getElementById('listOfitems');
            const childNodeToBeDeleted = document.getElementById(userId);
            if(childNodeToBeDeleted){
              parentNode.removeChild(childNodeToBeDeleted);
            }
          }
    </script>
  </body>
</html>
